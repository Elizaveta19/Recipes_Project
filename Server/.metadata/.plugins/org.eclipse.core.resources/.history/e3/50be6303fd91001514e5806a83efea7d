import java.net.*;
import java.io.*;
public class Server{
	static final int PORT = 8888;
	static String HostName = null;
	static long n = 0;
	static ServerSocket s;
	
	public static void main(String[] args) throws IOException {
	    try{
	        s = new ServerSocket(PORT);
	    }catch (IOException e) {
	        System.out.println("Порт: "+PORT+" занят");
	        return;
	    }
	    System.out.println("Запуск сервера АРЕНА");
	    System.out.println("Ожидаю клиентов....");
	    try {
	        //мониторю порт
	        while (true) {
	            Socket socket = s.accept();  //подключаю клиент
	            HostName=socket.getInetAddress().getHostName(); //получаю в переменную имя клиента
	            n++;
	            System.out.println("Соединение № "+ n +". Подключился клиент: "+HostName);
	            try {
	                new ServerMain(socket, HostName, n);
	            } catch (IOException e) {
	                System.out.println("Соединение № "+ n +" с клиентом: "+HostName+" разорвано");
	                socket.close();
	            }
	        }
	    } finally {
	        s.close();
	        System.out.println("Соединение с портом разорвано разорвано");
	
	    }
	}
}